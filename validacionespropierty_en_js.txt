define('MIN', 0);

document.getElementById('formPropierty').addEventListener('submit', function (e) {
    // Inicializar un flag de validación
    let isValid = true;
    const formData = new FormData(this); // Obtiene los datos del formulario
    const type = formData.get('type').trim(); // Usa el nombre del campo
    const zone = formData.get('zone').trim();
    const precioStr = formData.get('precio').trim(); // Usa el nombre del campo
    const precio = Number(precioStr); // Convierte el string a número
    const description = formData.get('description').trim();
    const mode = formData.get('mode').trim();
    const status = formData.get('status').trim();
    const city = formData.get('city').trim();

    // Validar que el campo Tipo no esté vacío
    if (!validarRequerido(type)) {
        alert('El campo Tipo es requerido.');
        isValid = false;
    }

    // Validar que el valor seleccionado no exceda los 20 caracteres
    if (type.length > 20) {
        alert('El tipo no puede tener más de 20 caracteres.');
        isValid = false;
    }

    // Validar que solo contenga letras y espacios
    const regex = /^[A-Za-z\s]+$/;
    if (!regex.test(type)) {
        alert('El tipo solo puede contener letras y espacios.');
        isValid = false;
    }

    // Validar que el valor sea una de las opciones permitidas
    const permittedOptions = ["apartament", "house", "lot", "countryHouse"]; // Opciones permitidas

    if (!permittedOptions.includes(type)) {
        alert('El tipo debe ser una opción válida (apartament, house, lot, countryHouse).');
        isValid = false;
    }

    // Validar que el campo Zona no esté vacío
    if (!validarRequerido(zone)) {
        alert('El campo Zona es requerido.');
        isValid = false;
    }

    // Validar que la zona no exceda los 45 caracteres
    if (zone.length > 45) {
        alert('La zona no puede tener más de 45 caracteres.');
        isValid = false;
    }

    // Validar que solo contenga letras, números y espacios
    const regexZone = /^[A-Za-z0-9\s]+$/;
    if (!regexZone.test(zone)) {
        alert('La zona solo puede contener letras, números y espacios.');
        isValid = false;
    }

    // Validar que el precio no esté vacío
    if (!validarRequerido(precioStr)) {
        alert('El campo Precio es requerido.');
        isValid = false;
    }

    // Validar que el precio sea un número entero
    if (!Number.isInteger(precio)) {
        alert('El precio debe ser un número entero.');
        isValid = false;
    }

    // Validar que el precio no sea menor a 0
    if (precio < MIN) {
        alert('El precio no puede ser menor a 0.');
        isValid = false;
    }

    // Validar que el precio no tenga más de 10 dígitos
    if (precio.toString().length > 10) {
        alert('El precio no puede tener más de 10 dígitos.');
        isValid = false;
    }

    // Si todas las validaciones son exitosas, se puede enviar el formulario
    if (!isValid) {
        e.preventDefault(); // Previene el envío si hay errores
    } else {
        this.submit(); // Envía el formulario si todas las validaciones pasan
    }
});

// Función para validar campos requeridos
function validarRequerido(campo) {
    return campo.trim() !== ''; // Asegura que el campo no esté vacío
}
